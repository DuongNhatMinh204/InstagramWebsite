

<!--<!DOCTYPE html>-->
<!--<html lang="vi">-->
<!--<head>-->
<!--    <meta charset="UTF-8" />-->
<!--    <title>K·∫øt Qu·∫£ T√¨m Ki·∫øm - Instagram Clone</title>-->
<!--    <link rel="stylesheet" href="/css/search-results.css">-->
<!--    <style>-->
<!--        /* Style cho navbar (gi·ªëng home.html) */-->
<!--        .nav-bar {-->
<!--            position: fixed;-->
<!--            top: 0;-->
<!--            width: 100%;-->
<!--            height: 64px;-->
<!--            background: white;-->
<!--            border-bottom: 1px solid #e5e7eb;-->
<!--            display: flex;-->
<!--            justify-content: space-between;-->
<!--            align-items: center;-->
<!--            padding: 0 28px;-->
<!--            z-index: 1000;-->
<!--            box-shadow: 0 1px 4px rgba(0,0,0,0.06);-->
<!--            overflow: hidden; /* NgƒÉn tr√†n n·∫øu c·∫ßn */-->
<!--        }-->
<!--        .nav-bar h1 {-->
<!--            font-size: 24px;-->
<!--            font-weight: 700;-->
<!--            background: linear-gradient(to right, #ff416c, #ff4b2b);-->
<!--            -webkit-background-clip: text;-->
<!--            -webkit-text-fill-color: transparent;-->
<!--            margin: 0;-->
<!--        }-->
<!--        .search-container {-->
<!--            display: flex;-->
<!--            align-items: center;-->
<!--            flex-grow: 1; /* Cho ph√©p m·ªü r·ªông ƒë·ªÉ c√¢n b·∫±ng kh√¥ng gian */-->
<!--            max-width: 300px; /* Gi·ªõi h·∫°n chi·ªÅu r·ªông t·ªëi ƒëa c·ªßa search */-->
<!--        }-->
<!--        .search-input {-->
<!--            padding: 5px;-->
<!--            width: 100%; /* S·ª≠ d·ª•ng 100% c·ªßa search-container */-->
<!--            max-width: 250px; /* Gi·ªõi h·∫°n ƒë·ªÉ tr√°nh tr√†n */-->
<!--            box-sizing: border-box; /* ƒê·∫£m b·∫£o padding kh√¥ng tƒÉng k√≠ch th∆∞·ªõc */-->
<!--        }-->
<!--        .search-button {-->
<!--            padding: 5px 10px;-->
<!--            background-color: #0095f6;-->
<!--            color: white;-->
<!--            border: none;-->
<!--            border-radius: 5px;-->
<!--            cursor: pointer;-->
<!--            margin-left: 5px;-->
<!--        }-->
<!--        .nav-items {-->
<!--            display: flex;-->
<!--            align-items: center;-->
<!--            gap: 16px;-->
<!--            margin-left: 10px; /* Th√™m margin ƒë·ªÉ t·∫°o kho·∫£ng c√°ch */-->
<!--        }-->
<!--        .nav-items span,-->
<!--        .nav-items button {-->
<!--            padding: 8px 14px;-->
<!--            font-weight: 500;-->
<!--            font-size: 15px;-->
<!--            background: #f9fafb;-->
<!--            border: 1px solid #d1d5db;-->
<!--            border-radius: 10px;-->
<!--            cursor: pointer;-->
<!--            transition: all 0.3s ease;-->
<!--            white-space: nowrap; /* NgƒÉn text b·ªã b·∫ª d√≤ng */-->
<!--        }-->
<!--        .nav-items span:hover,-->
<!--        .nav-items button:hover {-->
<!--            background: #e5e7eb;-->
<!--        }-->
<!--        #authNavButton {-->
<!--            position: relative;-->
<!--        }-->
<!--        .profile-dropdown-menu {-->
<!--            display: none;-->
<!--            position: absolute;-->
<!--            background-color: #fff;-->
<!--            box-shadow: 0 2px 4px rgba(0,0,0,0.1);-->
<!--            border-radius: 5px;-->
<!--            padding: 10px;-->
<!--            top: 50px;-->
<!--            right: 0;-->
<!--            min-width: 200px;-->
<!--        }-->
<!--        .profile-dropdown-menu.show {-->
<!--            display: block;-->
<!--        }-->
<!--        .dropdown-item {-->
<!--            padding: 5px 10px;-->
<!--            cursor: pointer;-->
<!--        }-->
<!--        .dropdown-item:hover {-->
<!--            background-color: #f0f0f0;-->
<!--        }-->

<!--        /* Style cho ph·∫ßn k·∫øt qu·∫£ t√¨m ki·∫øm */-->
<!--        .search-results-container {-->
<!--            max-width: 600px;-->
<!--            margin: 20px auto;-->
<!--            padding: 20px;-->
<!--            background: #fff;-->
<!--            border-radius: 10px;-->
<!--            box-shadow: 0 2px 8px rgba(0,0,0,0.07);-->
<!--            margin-top: 80px; /* ƒêi·ªÅu ch·ªânh ƒë·ªÉ tr√°nh ch·ªìng l·∫•p v·ªõi navbar c·ªë ƒë·ªãnh */-->
<!--        }-->

<!--        .search-results-header {-->
<!--            text-align: center;-->
<!--            margin-bottom: 20px;-->
<!--        }-->

<!--        .user-list {-->
<!--            list-style: none;-->
<!--            padding: 0;-->
<!--        }-->

<!--        .user-item {-->
<!--            display: flex;-->
<!--            align-items: center;-->
<!--            gap: 10px;-->
<!--            padding: 10px;-->
<!--            border-bottom: 1px solid #eee;-->
<!--            cursor: pointer;-->
<!--        }-->

<!--        .user-item img {-->
<!--            width: 40px;-->
<!--            height: 40px;-->
<!--            border-radius: 50%;-->
<!--            object-fit: cover;-->
<!--        }-->

<!--        .user-item .action-btn {-->
<!--            margin-left: auto;-->
<!--            padding: 5px 10px;-->
<!--            border: none;-->
<!--            border-radius: 5px;-->
<!--            cursor: pointer;-->
<!--        }-->

<!--        .user-item .follow-btn {-->
<!--            background-color: #4CAF50;-->
<!--            color: white;-->
<!--        }-->

<!--        .user-item .unfollow-btn {-->
<!--            background-color: #f44336;-->
<!--            color: white;-->
<!--        }-->

<!--        .user-item:hover {-->
<!--            background-color: #f0f0f0;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--&lt;!&ndash; Navigation (gi·ªëng home.html) &ndash;&gt;-->
<!--<nav class="nav-bar">-->
<!--    <h1>Instagram</h1>-->
<!--    <div class="search-container">-->
<!--        <input type="text" id="searchInput" class="search-input" placeholder="T√¨m ki·∫øm ng∆∞·ªùi d√πng..." autocomplete="off">-->
<!--        <button id="searchButton" class="search-button">üîç</button>-->
<!--    </div>-->
<!--    <div class="nav-items">-->
<!--        <span>üè† Home</span>-->
<!--        <div ></div>-->
<!--        <div></div>-->
<!--    </div>-->
<!--</nav>-->

<!--&lt;!&ndash; Container cho k·∫øt qu·∫£ t√¨m ki·∫øm &ndash;&gt;-->
<!--<div class="search-results-container">-->
<!--    <div class="search-results-header">-->
<!--        <h2>K·∫øt Qu·∫£ T√¨m Ki·∫øm</h2>-->
<!--    </div>-->
<!--    <ul id="userList" class="user-list"></ul>-->
<!--</div>-->

<!--<script src="/js/search.js"></script>-->
<!--<script>-->
<!--    // L·∫•y query t·ª´ URL-->
<!--    const urlParams = new URLSearchParams(window.location.search);-->
<!--    const query = urlParams.get('query');-->

<!--    console.log('Query from URL:', query); // Debug-->

<!--    if (query) {-->
<!--        document.title = `K·∫øt Qu·∫£ T√¨m Ki·∫øm cho "${query}" - Instagram Clone`;-->
<!--        // G·ªçi API t√¨m ki·∫øm-->
<!--        searchUsers(query, (users) => {-->
<!--            console.log('Search results:', users); // Debug-->
<!--            const userList = document.getElementById('userList');-->
<!--            if (users.length === 0) {-->
<!--                userList.innerHTML = '<li style="padding: 10px; color: #888;">Kh√¥ng t√¨m th·∫•y ng∆∞·ªùi d√πng.</li>';-->
<!--            } else {-->
<!--                // L·∫∑p qua t·ª´ng user ƒë·ªÉ ki·ªÉm tra tr·∫°ng th√°i follow-->
<!--                const promises = users.map(user => {-->
<!--                    return new Promise((resolve) => {-->
<!--                        checkFollow(user.id, (isFollowing) => {-->
<!--                            user.isFollowing = isFollowing; // Th√™m tr·∫°ng th√°i follow v√†o user-->
<!--                            resolve(user);-->
<!--                        });-->
<!--                    });-->
<!--                });-->

<!--                Promise.all(promises).then(updatedUsers => {-->
<!--                    userList.innerHTML = updatedUsers.map(user => `-->
<!--                            <li class="user-item" data-user-id="${user.id}">-->
<!--                                <img src="${user.avatar_url || '/images/logo.jpg'}" alt="${user.nickname}">-->
<!--                                <span>${user.nickname}</span>-->
<!--                                <button class="action-btn ${user.isFollowing ? 'unfollow-btn' : 'follow-btn'}"-->
<!--                                        data-user-id="${user.id}"-->
<!--                                        data-is-following="${user.isFollowing}">-->
<!--                                    ${user.isFollowing ? 'Unfollow' : 'Follow'}-->
<!--                                </button>-->
<!--                            </li>-->
<!--                        `).join('');-->

<!--                    // Th√™m event listener cho c√°c n√∫t sau khi t·∫°o-->
<!--                    document.querySelectorAll('.action-btn').forEach(btn => {-->
<!--                        btn.addEventListener('click', function() {-->
<!--                            const userId = this.getAttribute('data-user-id');-->
<!--                            const isFollowing = this.getAttribute('data-is-following') === 'true';-->
<!--                            if (isFollowing) {-->
<!--                                unfollowUser(userId, (response) => updateFollowStatus(userId, isFollowing, response));-->
<!--                            } else {-->
<!--                                followUser(userId, (response) => updateFollowStatus(userId, isFollowing, response));-->
<!--                            }-->
<!--                        });-->
<!--                    });-->
<!--                });-->
<!--            }-->
<!--        });-->
<!--    } else {-->
<!--        document.getElementById('userList').innerHTML = '<li style="padding: 10px; color: #888;">Kh√¥ng c√≥ t·ª´ kh√≥a t√¨m ki·∫øm.</li>';-->
<!--    }-->

<!--    // H√†m c·∫≠p nh·∫≠t tr·∫°ng th√°i sau khi follow/unfollow-->
<!--    function updateFollowStatus(userId, currentStatus, response) {-->
<!--        if (response.code === 1000) {-->
<!--            const userItem = document.querySelector(`.user-item[data-user-id="${userId}"] .action-btn`);-->
<!--            if (userItem) {-->
<!--                const isFollowing = !currentStatus; // Chuy·ªÉn ƒë·ªïi tr·∫°ng th√°i-->
<!--                userItem.className = `action-btn ${isFollowing ? 'unfollow-btn' : 'follow-btn'}`;-->
<!--                userItem.textContent = isFollowing ? 'Unfollow' : 'Follow';-->
<!--                userItem.setAttribute('data-is-following', isFollowing);-->
<!--            }-->
<!--        } else {-->
<!--            alert(response.data || 'Thao t√°c th·∫•t b·∫°i');-->
<!--        }-->
<!--    }-->

<!--    // H√†m m·ªü chat khi ch·ªçn ng∆∞·ªùi d√πng-->
<!--    function openChat(nickName, avatarUrl, userId) {-->
<!--        window.location.href = `/home?openChat=${userId}&nickName=${encodeURIComponent(nickName)}&avatarUrl=${encodeURIComponent(avatarUrl)}`;-->
<!--    }-->

<!--    // Th√™m s·ª± ki·ªán t√¨m ki·∫øm-->
<!--    document.addEventListener('DOMContentLoaded', function() {-->
<!--        const searchInput = document.getElementById('searchInput');-->
<!--        const searchButton = document.getElementById('searchButton');-->

<!--        if (searchButton && searchInput) {-->
<!--            searchButton.addEventListener('click', function() {-->
<!--                const query = searchInput.value.trim();-->
<!--                if (query) {-->
<!--                    window.location.href = `/search-results.html?query=${encodeURIComponent(query)}`;-->
<!--                }-->
<!--            });-->

<!--            searchInput.addEventListener('keydown', function(e) {-->
<!--                if (e.key === 'Enter') {-->
<!--                    searchButton.click();-->
<!--                }-->
<!--            });-->
<!--        }-->

<!--        // Logic ki·ªÉm tra ƒëƒÉng nh·∫≠p v√† hi·ªÉn th·ªã n√∫t profile-->
<!--        const authNavButtonContainer = document.getElementById('authNavButton');-->
<!--        const token = localStorage.getItem('token');-->

<!--        if (token) {-->
<!--            authNavButtonContainer.innerHTML = `-->
<!--                    <button id="openProfileDropdown">üë§ Profile</button>-->
<!--                    <div id="profileDropdownMenu" class="profile-dropdown-menu">-->
<!--                        <div class="dropdown-item" id="viewProfileBtn"><i class="bi bi-person-circle"></i> Xem t·∫•t c·∫£ trang c√° nh√¢n</div>-->
<!--                        <hr />-->
<!--                        <div class="dropdown-item"><i class="bi bi-gear-fill"></i> C√†i ƒë·∫∑t & quy·ªÅn ri√™ng t∆∞</div>-->
<!--                        <div class="dropdown-item"><i class="bi bi-question-circle-fill"></i> Tr·ª£ gi√∫p v√† h·ªó tr·ª£</div>-->
<!--                        <div class="dropdown-item"><i class="bi bi-moon-fill"></i> M√†n h√¨nh & tr·ª£ nƒÉng</div>-->
<!--                        <div class="dropdown-item"><i class="bi bi-chat-dots-fill"></i> ƒê√≥ng g√≥p √Ω ki·∫øn</div>-->
<!--                        <hr />-->
<!--                        <div class="dropdown-item" id="logoutBtn"><i class="bi bi-box-arrow-right"></i> ƒêƒÉng xu·∫•t</div>-->
<!--                    </div>-->
<!--                `;-->

<!--            const openProfileDropdownBtn = document.getElementById('openProfileDropdown');-->
<!--            const profileDropdownMenu = document.getElementById('profileDropdownMenu');-->
<!--            const logoutBtn = document.getElementById('logoutBtn');-->
<!--            const viewProfileBtnDropdown = document.getElementById('viewProfileBtn');-->

<!--            openProfileDropdownBtn.addEventListener('click', function(event) {-->
<!--                event.stopPropagation();-->
<!--                profileDropdownMenu.classList.toggle('show');-->
<!--            });-->

<!--            document.addEventListener('click', function(event) {-->
<!--                if (!authNavButtonContainer.contains(event.target)) {-->
<!--                    profileDropdownMenu.classList.remove('show');-->
<!--                }-->
<!--            });-->

<!--            if (logoutBtn) {-->
<!--                logoutBtn.addEventListener('click', function() {-->
<!--                    localStorage.removeItem('token');-->
<!--                    localStorage.removeItem('userId');-->
<!--                    window.location.href = '/login';-->
<!--                });-->
<!--            }-->

<!--            if (viewProfileBtnDropdown) {-->
<!--                viewProfileBtnDropdown.addEventListener('click', function() {-->
<!--                    const currentUserId = localStorage.getItem('userId');-->
<!--                    if (currentUserId) {-->
<!--                        window.location.href = `/profile?userId=${currentUserId}`;-->
<!--                    } else {-->
<!--                        alert('Kh√¥ng t√¨m th·∫•y th√¥ng tin ng∆∞·ªùi d√πng.');-->
<!--                    }-->
<!--                    profileDropdownMenu.classList.remove('show');-->
<!--                });-->
<!--            }-->
<!--        } else {-->
<!--            authNavButtonContainer.innerHTML = '<a href="/login" class="nav-item-link">üîì Login</a>';-->
<!--        }-->
<!--    });-->
<!--</script>-->
<!--</body>-->
<!--</html>-->

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <title>K·∫øt Qu·∫£ T√¨m Ki·∫øm - Instagram Clone</title>
    <link rel="stylesheet" href="/css/search-results.css">
    <style>
        /* Style cho navbar (gi·ªëng home.html) */
        .nav-bar {
            position: fixed;
            top: 0;
            width: 100%;
            height: 64px;
            background: white;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 28px;
            z-index: 1000;
            box-shadow: 0 1px 4px rgba(0,0,0,0.06);
            overflow: hidden; /* NgƒÉn tr√†n n·∫øu c·∫ßn */
        }
        .nav-bar h1 {
            font-size: 24px;
            font-weight: 700;
            background: linear-gradient(to right, #ff416c, #ff4b2b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 0;
        }
        .search-container {
            position: relative;
            margin-left: 5px;
            display: flex;
            align-items: center;
        }
        .search-input {
            padding: 8px 12px;
            border: 1px solid #ccc;
            border-radius: 20px;
            outline: none;
            width: 200px;
            font-size: 14px;
        }
        .search-button {
            padding: 8px 12px;
            margin-left: 5px;
            border: 1px solid #ccc;
            border-radius: 20px;
            background-color: #667eea;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 14px;
        }
        .search-button:hover {
            background-color: #5a67d8;
        }
        .nav-items {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-left: 10px; /* Th√™m margin ƒë·ªÉ t·∫°o kho·∫£ng c√°ch */
        }
        .nav-items span,
        .nav-items button {
            padding: 8px 14px;
            font-weight: 500;
            font-size: 15px;
            background: #f9fafb;
            border: 1px solid #d1d5db;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap; /* NgƒÉn text b·ªã b·∫ª d√≤ng */
        }
        .nav-items span:hover,
        .nav-items button:hover {
            background: #e5e7eb;
        }
        #authNavButton {
            position: relative;
        }
        .profile-dropdown-menu {
            display: none;
            position: absolute;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-radius: 5px;
            padding: 10px;
            top: 50px;
            right: 0;
            min-width: 200px;
        }
        .profile-dropdown-menu.show {
            display: block;
        }
        .dropdown-item {
            padding: 5px 10px;
            cursor: pointer;
        }
        .dropdown-item:hover {
            background-color: #f0f0f0;
        }

        /* Style cho ph·∫ßn k·∫øt qu·∫£ t√¨m ki·∫øm */
        .search-results-container {
            max-width: 600px;
            margin: 20px auto;
            padding: 20px;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.07);
            margin-top: 80px; /* ƒêi·ªÅu ch·ªânh ƒë·ªÉ tr√°nh ch·ªìng l·∫•p v·ªõi navbar c·ªë ƒë·ªãnh */
        }

        .search-results-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .user-list {
            list-style: none;
            padding: 0;
        }

        .user-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
        }

        .user-item img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }

        .user-item .action-btn {
            margin-left: auto;
            padding: 5px 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .user-item .follow-btn {
            background-color: #4CAF50;
            color: white;
        }

        .user-item .unfollow-btn {
            background-color: #f44336;
            color: white;
        }

        .user-item:hover {
            background-color: #f0f0f0;
        }
    </style>
</head>
<body>
<!-- Navigation (gi·ªëng home.html) -->
<nav class="nav-bar">
    <h1>Instagram</h1>
    <div class="search-container">
        <input type="text" id="searchInput" class="search-input" placeholder="T√¨m ki·∫øm ng∆∞·ªùi d√πng..." autocomplete="off">
        <button id="searchButton" class="search-button">üîç</button>
    </div>
    <div class="nav-items">
        <span>üè† Home</span>
        <div></div>
        <div></div>
        <div></div>
    </div>
</nav>

<!-- Container cho k·∫øt qu·∫£ t√¨m ki·∫øm -->
<div class="search-results-container">
    <div class="search-results-header">
        <h2>K·∫øt Qu·∫£ T√¨m Ki·∫øm</h2>
    </div>
    <ul id="userList" class="user-list"></ul>
</div>

<script src="/js/search.js"></script>
<script>
    // L·∫•y query t·ª´ URL
    const urlParams = new URLSearchParams(window.location.search);
    const query = urlParams.get('query');

    console.log('Query from URL:', query); // Debug

    if (query) {
        document.title = `K·∫øt Qu·∫£ T√¨m Ki·∫øm cho "${query}" - Instagram Clone`;
        // G·ªçi API t√¨m ki·∫øm
        searchUsers(query, (users) => {
            console.log('Search results:', users); // Debug
            const userList = document.getElementById('userList');
            if (users.length === 0) {
                userList.innerHTML = '<li style="padding: 10px; color: #888;">Kh√¥ng t√¨m th·∫•y ng∆∞·ªùi d√πng.</li>';
            } else {
                // L·∫∑p qua t·ª´ng user ƒë·ªÉ ki·ªÉm tra tr·∫°ng th√°i follow
                const promises = users.map(user => {
                    return new Promise((resolve) => {
                        checkFollow(user.id, (isFollowing) => {
                            user.isFollowing = isFollowing; // Th√™m tr·∫°ng th√°i follow v√†o user
                            resolve(user);
                        });
                    });
                });

                Promise.all(promises).then(updatedUsers => {
                    userList.innerHTML = updatedUsers.map(user => `
                            <li class="user-item" data-user-id="${user.id}">
                                <img src="${user.avatar_url || '/images/logo.jpg'}" alt="${user.nickname}">
                                <span>${user.nickname}</span>
                                <button class="action-btn ${user.isFollowing ? 'unfollow-btn' : 'follow-btn'}"
                                        data-user-id="${user.id}"
                                        data-is-following="${user.isFollowing}">
                                    ${user.isFollowing ? 'Unfollow' : 'Follow'}
                                </button>
                            </li>
                        `).join('');

                    // Th√™m event listener cho c√°c n√∫t sau khi t·∫°o
                    document.querySelectorAll('.action-btn').forEach(btn => {
                        btn.addEventListener('click', function() {
                            const userId = this.getAttribute('data-user-id');
                            const isFollowing = this.getAttribute('data-is-following') === 'true';
                            if (isFollowing) {
                                unfollowUser(userId, (response) => updateFollowStatus(userId, isFollowing, response));
                            } else {
                                followUser(userId, (response) => updateFollowStatus(userId, isFollowing, response));
                            }
                        });
                    });
                });
            }
        });
    } else {
        document.getElementById('userList').innerHTML = '<li style="padding: 10px; color: #888;">Kh√¥ng c√≥ t·ª´ kh√≥a t√¨m ki·∫øm.</li>';
    }

    // H√†m c·∫≠p nh·∫≠t tr·∫°ng th√°i sau khi follow/unfollow
    function updateFollowStatus(userId, currentStatus, response) {
        if (response.code === 1000) {
            const userItem = document.querySelector(`.user-item[data-user-id="${userId}"] .action-btn`);
            if (userItem) {
                const isFollowing = !currentStatus; // Chuy·ªÉn ƒë·ªïi tr·∫°ng th√°i
                userItem.className = `action-btn ${isFollowing ? 'unfollow-btn' : 'follow-btn'}`;
                userItem.textContent = isFollowing ? 'Unfollow' : 'Follow';
                userItem.setAttribute('data-is-following', isFollowing);
            }
        } else {
            alert(response.data || 'Thao t√°c th·∫•t b·∫°i');
        }
    }

    // H√†m m·ªü chat khi ch·ªçn ng∆∞·ªùi d√πng
    function openChat(nickName, avatarUrl, userId) {
        window.location.href = `/home?openChat=${userId}&nickName=${encodeURIComponent(nickName)}&avatarUrl=${encodeURIComponent(avatarUrl)}`;
    }

    // Th√™m s·ª± ki·ªán t√¨m ki·∫øm
    document.addEventListener('DOMContentLoaded', function() {
        const searchInput = document.getElementById('searchInput');
        const searchButton = document.getElementById('searchButton');
        const homeButton = document.querySelector('.nav-items span'); // L·∫•y n√∫t Home

        if (searchButton && searchInput) {
            searchButton.addEventListener('click', function() {
                const query = searchInput.value.trim();
                if (query) {
                    window.location.href = `/search-results.html?query=${encodeURIComponent(query)}`;
                }
            });

            searchInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    searchButton.click();
                }
            });
        }

        // Th√™m s·ª± ki·ªán click cho n√∫t Home
        if (homeButton) {
            homeButton.addEventListener('click', function() {
                window.location.href = '/home'; // Chuy·ªÉn v·ªÅ trang ch√≠nh
            });
        }

        // Logic ki·ªÉm tra ƒëƒÉng nh·∫≠p v√† hi·ªÉn th·ªã n√∫t profile
        const authNavButtonContainer = document.getElementById('authNavButton');
        const token = localStorage.getItem('token');

        if (token) {
            authNavButtonContainer.innerHTML = `
                    <button id="openProfileDropdown">üë§ Profile</button>
                    <div id="profileDropdownMenu" class="profile-dropdown-menu">
                        <div class="dropdown-item" id="viewProfileBtn"><i class="bi bi-person-circle"></i> Xem t·∫•t c·∫£ trang c√° nh√¢n</div>
                        <hr />
                        <div class="dropdown-item"><i class="bi bi-gear-fill"></i> C√†i ƒë·∫∑t & quy·ªÅn ri√™ng t∆∞</div>
                        <div class="dropdown-item"><i class="bi bi-question-circle-fill"></i> Tr·ª£ gi√∫p v√† h·ªó tr·ª£</div>
                        <div class="dropdown-item"><i class="bi bi-moon-fill"></i> M√†n h√¨nh & tr·ª£ nƒÉng</div>
                        <div class="dropdown-item"><i class="bi bi-chat-dots-fill"></i> ƒê√≥ng g√≥p √Ω ki·∫øn</div>
                        <hr />
                        <div class="dropdown-item" id="logoutBtn"><i class="bi bi-box-arrow-right"></i> ƒêƒÉng xu·∫•t</div>
                    </div>
                `;

            const openProfileDropdownBtn = document.getElementById('openProfileDropdown');
            const profileDropdownMenu = document.getElementById('profileDropdownMenu');
            const logoutBtn = document.getElementById('logoutBtn');
            const viewProfileBtnDropdown = document.getElementById('viewProfileBtn');

            openProfileDropdownBtn.addEventListener('click', function(event) {
                event.stopPropagation();
                profileDropdownMenu.classList.toggle('show');
            });

            document.addEventListener('click', function(event) {
                if (!authNavButtonContainer.contains(event.target)) {
                    profileDropdownMenu.classList.remove('show');
                }
            });

            if (logoutBtn) {
                logoutBtn.addEventListener('click', function() {
                    localStorage.removeItem('token');
                    localStorage.removeItem('userId');
                    window.location.href = '/login';
                });
            }

            if (viewProfileBtnDropdown) {
                viewProfileBtnDropdown.addEventListener('click', function() {
                    const currentUserId = localStorage.getItem('userId');
                    if (currentUserId) {
                        window.location.href = `/profile?userId=${currentUserId}`;
                    } else {
                        alert('Kh√¥ng t√¨m th·∫•y th√¥ng tin ng∆∞·ªùi d√πng.');
                    }
                    profileDropdownMenu.classList.remove('show');
                });
            }
        } else {
            authNavButtonContainer.innerHTML = '<a href="/login" class="nav-item-link">üîì Login</a>';
        }
    });
</script>
</body>
</html>